# Excel_Clients_Invoices

Excel to management clients, benefits and invoices for a very small enterprise or autonomous

This project have been create to help a french friend so all the fileds are in french. My friend is ergotherapist and needed something very simple to manage her clients and the appointment with them and she could control her benefits and her outstanding pacients. She had an Excel file to do this function so I decided mantein Excel but introducing some automatization (macros and formulas) to facilitate her the work.

The new Excel file have 5 parts:

- Part 1 - This is the first sheet and it's only to access to the diferent sheets like a link

- Part 2 - It is formed by 2 sheets and they are two databases:
    - Pacients
       - Have the diferent clients
       - One line is a unique client
       - The fields are divided in 3 blocks:
           - White fields
                - These fields are the cells on which the information collected in the Formulaire Patient will be copied.
                - These fields are:
                    - PRENOM
                    - NOM1
                    - DATE NAISSANCE
                    - PATHOLOGIE
                    - OBSERVATIONS
                    - TELEPHONE1
                    - TELEPHONE2
                    - EMAIL1
                    - EMAIL2
                    - DEPARTEMENT
                    - COMMUNE
                    - ADRESSE
           - Blue fields
                - These fields are cells with formulas and they should not be modified
                - These fields are:
                    - PACIENT - Concatenation of the patient's name and surname
                    - CODE PACIENT - Unique code for each patient
                    - DATE DE SORTIE - Patient creation date
                    - AGE - Age of the patient
                    - AN - Years to the patient's date of birth
                    - MOIS - Meses hasta la fecha de nacimiento del paciente
                    - Nº SEANCES - Months to the patient's date of birth
           - Hidden fields
                - These fields are child cells for calculations and background tasks
                - These fields are:
                    -  DEPARTEMENT+COMMUNE2
                    -  Columna1 - Separation cell
                    -  Columna2 - Separation cell
                    -  PRENOM2 - Receive the information of the Formulaire Pacient cells
                    -  NOM12 - Receive the information of the Formulaire Pacient cells
                    -  DATE NAISSANCE (DD/MM/YYYY) - Receive the information from the Formulaire Pacient cells
                    -  PATHOLOGIE2 - Receive the information of the Formulaire Pacient cells
                    -  OBSERVATIONS3 - Receive the information of the Formulaire Pacient cells
                    -  TELEPHONE12 - Receive the information of the Formulaire Pacient cells
                    -  TELEPHONE23 - Receive the information of the Formulaire Pacient cells
                    -  EMAIL14 - Receive the information of the Formulaire Pacient cells
                    -  EMAIL25 - Receive the information of the Formulaire Pacient cells
                    -  DEPARTMENT - Receive the information of the Formulaire Pacient cells
                    -  COMUNA - Receive the information of the Formulaire Pacient cells
                    -  ADRESSE6 - Receive the information of the Formulaire Pacient cells
                    -  AN2 - Used to calculate the formulas of the Rapport Patients
                    -  NOMBRE PACIENT - Used to calculate the formulas of the Rapport Patients sheet
                    -  no paye - Used to calculate the formulas of the Rapport Patients sheet
                    -  paye - Used to calculate the formulas of the Rapport Patients sheet
    - Seances
       - Have the differents appoinments with the differents clients
       - It can have many lines for the same pacient
       - The fields are divided in 3 blocks:
           - White fields
                - These fields are the cells on which the information collected in the Formulaire Seances will be copied.
                - These fields are:
                    - DATE  SEANCE
                    - MODE DE PAIEMENT
                    - TYPE DE SESSION
                    - POURCENTAGE
           - Blue fields
                - These fields are cells with formulas and they should not be modified
                - These fields are:
                    - CODE SEANCE - Unique code for each session
                    - PACIENT - Concatenation of the patient's name and surname
                    - PRIX  SEANCE - Price of the session (It is filled in automatically when entering the type of session in the session form)
                    - PROPRE BÉNÉFICE - Calculates the benefit for the user according to the percentage indicated in the session form
                    - CLINIC BÉNÉFICE - Calculates the benefit for the clinic according to the percentage indicated in the session form
                    - TOTAL BÉNÉFICE - Calculate the total profit of the session, which must coincide with the price of the session
                    - STATUS - It tells us if the session is paid or not based on what is indicated in the PAYÉ cell
           - Hidden fields
                - These fields are child cells for calculations and background tasks
                - These fields are:
                    -  status_2 - Used for calculations in the Patients sheet
                    -  DATE SEANCE + PACIENT + FACT - Used for calculations in the Formulaire Invoice sheet
                    -  AN - Used to calculate the formulas of the Rapport Seances sheet
                    -  SEANCES - Used to calculate the formulas of the Rapport Seances sheet
                    -  Column1 - Separation cell
                    -  PATIENT - Receive the information from the Formulaire Seances cells
                    -  DATE SEANCE (DD / MM / YYYY) - Receive the information from the Formulaire Seances cells
                    -  MODE DE PAIEMENT2 - Receive the information of the Formulaire Seances cells
                    -  TYPE DE SESSION2 - Receive the information of the Formulaire Seances cells
                    -  TYPE DE GAGNER2 - Receive the cell information of Formulaire Seances
- Part 3 - It is formed by 3 sheets and they are the formularies to entry the information to the differents fields of the databases sheets:
    - Formulaire Pacient
        - This sheet contains 2 macros:
            - Macro to create a new row in the Patients sheet and add the white fields to that new line
            - Macro to clean the form in case of error
        - The fields are divided in 2 blocks:
            - Grey fields
                - These fields are cells with formulas and they should not be modified
                - These fields are:
                    - CODE PATIENT - Generates a unique and consecutive code for each new patient
                    - DATE DE SORTIE - Generates the date on which the new patient is discharged
            - White fields
                - These fields are the cells that must be filled in to collect the patient's information
                - These fields are:
                    - PRENOM - Patient name
                    - NOM1 - Patient's last name
                    - DATE NAISSANCE (DD / MM / YYYY) - Patient's year of birth
                    - PATHOLOGIE - Pathology for which the patient attends consultation
                    - OBSERVATIONS - Other relevant observations about the patient
                    - TELEPHONE1 - Patient's main phone
                    - TELEPHONE2 - Another phone to locate the patient
                    - EMAIL1 - Patient's email
                    - EMAIL2 - Secondary email of the patient
                    - DEPARTEMENT - Department to which the patient belongs
                    - COMMUNE - Town to which the patient belongs
                    - ADRESSE - Patient address
    - Formulaire Seance
        - This sheet contains 2 macros:
            - Macro to create a new row in the Patients sheet and add the white fields to that new line
            - Macro to clean the form in case of error 
        - The fields are divided in 2 blocks:
            - Grey fields
                - These fields are cells with formulas and they should not be modified
                - These fields are:
                    - CODE SEANCE- Generates a unique and consecutive code for each new query
            - White fields
                - These fields are the cells that must be filled in to collect the season's information
                - These fields are:
                    - PATIENT - This cell is filled in as a list. The list is made up of each of the patients discharged to date
                    - DATE SEANCE (DD / MM / YYYY) - Date of the session
                    - MODE DE PAIEMENT - Session payment method
                    - TYPE OF SESSION - Type of session (Each type of session has a price)
                    - POURCENTAGE - Type of percentage that is applied to the session depending on whether the patient is seen at the collaborating clinic or at the therapist's home 
    - Formulaire Facture
        - This form is a template to generate invoices
        - The fields are divided into 4 parts:
            - Fixed fields that do not change (Clinic or therapist data)
            - Fields that can be modified by the user (Invoice No., Data Seance or Km)
            - Automated fields that autocomplete based on another field:
                - The patient's data is filled in according to the Invoice No. entered
                - Detail of the Performance and Tarif Applique are filled according to what was entered in Data Seance and Km
                - Hidden fields that are autocompleted and used to autocomplete other fields on the same sheet
- Part 4 - This is a sheet to see individualy the relevant information of each pacient
    - The fields are divided into 2 parts:
        - Blue field - This field contains the list of patients
        - White fields - These fields are auto-filled with relevant patient information
- Part 5 - It is formed by 2 sheets and they are dashboards to visualizaice the important data of the 2 databases sheets
    - Rapport Patients
        - This sheet is a report to know the patient data
        - It gives us the information of:
            - Number of total clients
            - Number of clients that are pending payment and up-to-date with payments (Can be filtered by year)
            - 2 graphics:
                - Number of clients based on their age
                - Number of clients depending on their population
    - Rapport Seances
        - This sheet is a report on the session data
        - It gives us information on:
            - Total number of sessions carried out (Can be filtered by year)
            - Total benefits (Can be filtered by year)
            - Therapist benefit (May filter by year)
            - Benefit of the collaborating clinic (Can be filtered by the year)
            - 7 graphs modifiable from a time filter (by years, months, quarters and days):
                - Number of sessions for each client
                - Number of total sessions
                - Total number of benefits (It does not take into account if the benefit is from the therapist or from the clinic)
                - Benefit Sharing (Cumulative bar graph showing the benefits of the therapist and the clinic separately)
                - Number of sessions depending on the payment method used
                - Number of sessions depending on the type of session
                - Number of sessions depending on the percentage applied to the prices of each consultation
